<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RistoranteMoka - Ordina dal Tavolo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="menu.css" /> <!-- Includi CSS esterno -->
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-8">
                    <h1 class="h4 mb-1"><i class="fas fa-utensils me-2"></i>RistoranteMoka</h1>
                    <p class="mb-0 opacity-75">Ordina dal tuo tavolo</p>
                </div>
                <div class="col-4 text-end">
                    <div class="info-tavolo">
                        <i class="fas fa-table me-1"></i>
                        Tavolo: <span id="tavolo-numero">--</span>
                        <span id="cliente-corrente-container">
                            | <i class="fas fa-user ms-2 me-1"></i>
                            Cliente: <span id="cliente-corrente">--</span>
                        </span>
                    </div>
                    <div id="back-to-cameriere-container" style="margin-top: 8px; display: none;">
                        <button class="btn btn-sm btn-outline-light" id="btn-back-to-cameriere">
                            <i class="fas fa-arrow-left me-1"></i>
                            Torna alla Home cameriere
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Menu -->
    <div class="container mt-4 mb-5">
        <div id="loading">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Caricamento...</span>
            </div>
            <p class="mt-3">Caricamento menu...</p>
        </div>
        <div id="menu" style="display: none;"></div>
    </div>

    <!-- Carrello -->
    <div id="carrello" style="display: none;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-7">
                    <h5 class="mb-2">Il tuo ordine</h5>
                    <div id="carrello-contenuto"></div>
                    <div class="mt-2">
                        <strong>Totale: €<span id="totale-prezzo">0.00</span></strong>
                        <span class="text-muted ms-2">(<span id="totale-articoli">0</span> articoli)</span>
                    </div>
                </div>
                <div class="col-5 text-end">
                    <button id="btn-invia-ordine" class="btn btn-success btn-lg">
                        <i class="fas fa-paper-plane me-2"></i>INVIA ALLA CUCINA
                    </button>
                    <button class="btn btn-outline-secondary btn-sm mt-2" onClick="svuotaCarrello()">
                        <i class="fas fa-trash me-1"></i>Svuota
                    </button>
                </div>
            </div>
        </div>
    </div>
 <!-- NOTE:
         - Manteniamo il markup del modal "Aggiungi Bevande" in un <template> (non attivo nel DOM)
           così non viene gestito da Bootstrap ma può essere ripristinato facilmente in futuro.
         - Disabilitiamo SOLO i trigger che aprono #modal-bevande (pulsante "Aggiungi altre bevande")
           senza toccare altri modali o i trigger che aprono il modal "ordina" accanto alla lista bevande.
    -->
    <!-- (modali e template omessi per brevità; rimangono invariati) -->
    <!-- Modal "Aggiungi Bevande" -->
    <div class="modal fade" id="modal-bevande" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"><i class="fas fa-wine-glass-alt me-2"></i>Aggiungi Bevande</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Chiudi"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label class="form-label">Seleziona bevanda</label>
          <select class="form-select" id="select-bevanda">
            <option value="7">Acqua naturale 1L - €2.50</option>
            <option value="11">Acqua frizzante 1L - €2.50</option>
            <option value="8">Vino rosso (bottiglia) - €18.00</option>
            <option value="9">Vino bianco (bottiglia) - €16.00</option>
            <option value="16">Birra artigianale 0.5L - €5.00</option>
            <option value="10">Coca Cola 0.33L - €3.00</option>
            <option value="12">Succo di frutta - €4.00</option>
            <option value="13">Caffè - €1.50</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">Condivisione</label>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="condivisione-bevanda" id="cond-personale" value="personale" checked>
            <label class="form-check-label" for="cond-personale"><i class="fas fa-user me-1"></i> Solo per me</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="condivisione-bevanda" id="cond-tavolo" value="tavolo">
            <label class="form-check-label" for="cond-tavolo"><i class="fas fa-users me-1"></i> Per tutto il tavolo</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="condivisione-bevanda" id="cond-gruppo" value="gruppo">
            <label class="form-check-label" for="cond-gruppo"><i class="fas fa-user-friends me-1"></i> Per me e per (seleziona gli altri)
              <small id="gruppo-selezione-txt" class="text-muted ms-2"></small></label>
          </div>

          <div id="selettore-partecipanti" style="display:none;" class="border rounded p-2 mb-3">
            <div class="small text-muted mb-2">Seleziona i partecipanti (tu sarai incluso automaticamente):</div>
            <div id="partecipanti-list" class="d-flex flex-wrap gap-2"></div>
            <div id="selettore-error" class="text-danger small mt-2" style="display:none;">Seleziona almeno 1 partecipante oltre a te.</div>
          </div>
        </div>
        <div class="alert alert-info"><i class="fas fa-info-circle me-2"></i><small>Le bevande verranno aggiunte al carrello e condivise secondo la modalità scelta.</small></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
        <button type="button" class="btn btn-primary" id="btn-modal-aggiungi-bevanda"><i class="fas fa-plus me-1"></i>Aggiungi al carrello</button>
      </div>
    </div>
  </div>
</div>

    <!-- Modal I miei ordini -->
    <div class="modal fade" id="modal-miei-ordini" tabindex="-1" aria-hidden="true"> ... </div>

    <!-- Altri modali (restano invariati) -->
    <div id="modale-selezione-cliente" class="modal" style="display: none;"></div>
    <div id="modale-aggiungi-bevanda" class="modal" style="display: none;"> ... </div>

    <!-- IMPORTANT: include modal-accessibility.js BEFORE bootstrap bundle so capture listeners run first -->
    <script src="inizializza/js/modal-accessibility.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- state module (se esiste) -->
    <script src="inizializza/js/state.js"></script>

    <!-- stato compatibilità estratto: caricare state-shim.js SUBITO DOPO state.js -->
    <script src="inizializza/js/state-shim.js"></script>

    <!-- altri moduli di inizializzazione -->
    <script src="inizializza/js/cart-ui.js"></script>
    <script src="inizializza/js/api-service.js"></script>

    <!-- script principale della pagina -->
    <script src="inizializza/js/menu-renderer.js"></script>
<script src="menu.js"></script> <!-- Includi JS esterno -->
</body>
</html>